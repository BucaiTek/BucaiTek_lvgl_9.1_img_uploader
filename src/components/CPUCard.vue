<script setup lang="ts">
import { useHardwareStore } from '@/stores/useHardwareStore'
import { useI18n } from 'vue-i18n'
const { t, locale } = useI18n()
const hardwareStore = useHardwareStore()

const formatNetSpeed = (bytes: number | null, decimals = 2) => {
  if (bytes === null) return { speed: '', unit: '' }
  if (bytes === 0) return { speed: '0', unit: 'B/s' }
  const k = 1024
  const dm = decimals < 0 ? 0 : decimals
  const sizes = ['B/s', 'KB/s', 'MB/s', 'GB/s', 'TB/s', 'PB/s', 'EB/s', 'ZB/s', 'YB/s']
  let i = Math.floor(Math.log(bytes) / Math.log(k))

  if (bytes / Math.pow(k, i) > 999 && i < sizes.length - 1) {
    i++
  }

  return {
    speed: parseFloat((bytes / Math.pow(k, i)).toFixed(dm)),
    unit: sizes[i]
  }
}
</script>

<template>
  <div class="cpu-card">
    <n-collapse-transition
      :show="hardwareStore.net.bandwidthUp != null"
      style="display: flex; justify-content: center"
    >
      <n-icon size="35">
        <svg
          id="Capa_1"
          enable-background="new 0 0 512.001 512.001"
          height="512"
          viewBox="0 0 512.001 512.001"
          width="512"
          xmlns="http://www.w3.org/2000/svg"
        >
          <g>
            <g id="Page-1_1_">
              <g id="_x30_02---CPU">
                <path
                  id="Shape_7_"
                  d="m128.001 162.134c4.713 0 8.533-3.821 8.533-8.533v-17.067h17.067c4.713 0 8.533-3.821 8.533-8.533 0-4.713-3.821-8.533-8.533-8.533h-25.6c-4.713 0-8.533 3.821-8.533 8.533v25.6c-.001 4.712 3.82 8.533 8.533 8.533z"
                />
                <path
                  id="Shape_6_"
                  d="m136.534 230.4v51.2c0 18.851 15.282 34.133 34.133 34.133s34.133-15.282 34.133-34.133c0-4.713-3.821-8.533-8.533-8.533s-8.533 3.82-8.533 8.533c0 9.426-7.641 17.067-17.067 17.067s-17.067-7.641-17.067-17.067v-51.2c0-9.426 7.641-17.067 17.067-17.067s17.067 7.641 17.067 17.067c0 4.713 3.82 8.533 8.533 8.533s8.533-3.821 8.533-8.533c0-18.851-15.282-34.133-34.133-34.133s-34.133 15.282-34.133 34.133z"
                />
                <path
                  id="Shape_2_"
                  d="m230.401 315.734c4.713 0 8.533-3.82 8.533-8.533v-42.667h17.067c18.851 0 34.133-15.282 34.133-34.133s-15.282-34.133-34.133-34.133h-25.6c-4.713 0-8.533 3.821-8.533 8.533v102.4c-.001 4.712 3.82 8.533 8.533 8.533zm8.533-102.4h17.067c9.426 0 17.067 7.641 17.067 17.067s-7.641 17.067-17.067 17.067h-17.067z"
                />
                <path
                  id="Shape_3_"
                  d="m341.334 315.734c18.851 0 34.133-15.282 34.133-34.133v-76.8c0-4.713-3.82-8.533-8.533-8.533s-8.533 3.821-8.533 8.533v76.8c0 9.426-7.641 17.067-17.067 17.067s-17.067-7.641-17.067-17.067v-76.8c0-4.713-3.82-8.533-8.533-8.533s-8.533 3.821-8.533 8.533v76.8c0 18.851 15.282 34.133 34.133 34.133z"
                />
                <path
                  id="Shape_4_"
                  d="m418.134 85.334h-324.267c-4.713 0-8.533 3.821-8.533 8.533v324.267c0 4.713 3.821 8.533 8.533 8.533h324.267c4.713 0 8.533-3.82 8.533-8.533v-324.267c0-4.713-3.82-8.533-8.533-8.533zm-8.533 324.267h-307.2v-307.201h307.2z"
                />
                <path
                  id="Shape_5_"
                  d="m486.401 153.6c14.109-.07 25.53-11.491 25.6-25.6 0-14.138-11.462-25.6-25.6-25.6h-25.6v-8.533c-.028-23.552-19.114-42.638-42.667-42.667h-8.533v-25.6c.049-6.758-2.642-13.248-7.458-17.988-4.761-4.898-11.312-7.646-18.142-7.612-14.138 0-25.6 11.462-25.6 25.6v25.6h-34.133v-25.6c.049-6.758-2.642-13.248-7.458-17.988-4.762-4.898-11.312-7.646-18.143-7.612-14.138 0-25.6 11.462-25.6 25.6v25.6h-34.133v-25.6c.049-6.758-2.642-13.248-7.458-17.988-4.761-4.898-11.311-7.646-18.142-7.612-14.138 0-25.6 11.462-25.6 25.6v25.6h-34.133v-25.6c.049-6.758-2.642-13.248-7.458-17.988-4.761-4.898-11.312-7.646-18.142-7.612-14.138 0-25.6 11.462-25.6 25.6v25.6h-8.533c-23.552.028-42.638 19.114-42.667 42.667v8.533h-25.6c-14.138 0-25.6 11.462-25.6 25.6-.049 6.758 2.642 13.248 7.458 17.988 4.761 4.898 11.311 7.646 18.142 7.612h25.6v34.133h-25.6c-14.138 0-25.6 11.462-25.6 25.6-.049 6.758 2.642 13.248 7.458 17.988 4.761 4.898 11.311 7.646 18.142 7.612h25.6v34.133h-25.6c-6.79 0-13.301 2.697-18.102 7.498s-7.498 11.312-7.498 18.102c-.049 6.758 2.642 13.248 7.458 17.988 4.761 4.898 11.311 7.646 18.142 7.612h25.6v34.133h-25.6c-14.138 0-25.6 11.462-25.6 25.6-.049 6.758 2.642 13.248 7.458 17.988 4.761 4.898 11.311 7.646 18.142 7.612h25.6v8.533c.028 23.552 19.114 42.638 42.667 42.667h8.533v25.6c0 14.138 11.462 25.6 25.6 25.6 14.109-.07 25.53-11.491 25.6-25.6v-25.6h34.133v25.6c0 14.138 11.462 25.6 25.6 25.6 14.109-.07 25.53-11.491 25.6-25.6v-25.6h34.133v25.6c0 6.79 2.697 13.301 7.498 18.102s11.312 7.498 18.102 7.498c14.109-.07 25.53-11.491 25.6-25.6v-25.6h34.133v25.6c0 14.138 11.462 25.6 25.6 25.6 14.109-.07 25.53-11.491 25.6-25.6v-25.6h8.533c23.552-.028 42.638-19.114 42.667-42.667v-8.533h25.6c14.109-.07 25.53-11.491 25.6-25.6 0-14.138-11.462-25.6-25.6-25.6h-25.6v-34.133h25.6c14.109-.07 25.53-11.491 25.6-25.6 0-14.138-11.462-25.6-25.6-25.6h-25.6v-34.133h25.6c14.109-.07 25.53-11.491 25.6-25.6 0-14.138-11.462-25.6-25.6-25.6h-25.6v-34.133zm0-34.133c4.713 0 8.533 3.821 8.533 8.533.007 2.299-.938 4.499-2.611 6.076-1.556 1.592-3.696 2.48-5.922 2.458h-25.6v-17.067zm-110.934-93.867c0-4.713 3.82-8.533 8.533-8.533 2.299-.007 4.499.938 6.076 2.611 1.592 1.556 2.48 3.696 2.458 5.922v25.6h-17.067zm-85.333 0c0-4.713 3.821-8.533 8.533-8.533 2.299-.007 4.499.938 6.076 2.611 1.592 1.556 2.48 3.696 2.458 5.922v25.6h-17.067zm-85.333 0c0-4.713 3.82-8.533 8.533-8.533 2.299-.007 4.499.938 6.076 2.611 1.592 1.556 2.48 3.696 2.458 5.922v25.6h-17.067zm-85.334 0c0-4.713 3.821-8.533 8.533-8.533 2.299-.007 4.499.938 6.076 2.611 1.592 1.556 2.48 3.696 2.458 5.922v25.6h-17.067zm-93.866 110.934c-2.299.007-4.499-.938-6.076-2.611-1.592-1.556-2.48-3.696-2.458-5.922 0-4.713 3.821-8.533 8.533-8.533h25.6v17.067zm0 85.333c-2.299.007-4.499-.938-6.076-2.611-1.592-1.556-2.48-3.696-2.458-5.922 0-4.713 3.821-8.533 8.533-8.533h25.6v17.067zm0 85.334c-2.299.007-4.499-.938-6.076-2.611-1.592-1.556-2.48-3.696-2.458-5.922 0-4.713 3.821-8.533 8.533-8.533h25.6v17.067zm0 85.333c-2.299.007-4.499-.938-6.076-2.611-1.592-1.556-2.48-3.696-2.458-5.922 0-4.713 3.821-8.533 8.533-8.533h25.6v17.067zm110.933 93.867c.007 2.299-.938 4.499-2.611 6.076-1.556 1.592-3.696 2.48-5.922 2.458-4.713 0-8.533-3.82-8.533-8.533v-25.6h17.067zm85.333 0c.007 2.299-.938 4.499-2.611 6.076-1.556 1.592-3.696 2.48-5.922 2.458-4.713 0-8.533-3.82-8.533-8.533v-25.6h17.067zm85.334 0c.007 2.299-.938 4.499-2.611 6.076-1.556 1.592-3.696 2.48-5.922 2.458-4.713 0-8.533-3.82-8.533-8.533v-25.6h17.067zm85.333 0c.007 2.299-.938 4.499-2.611 6.076-1.556 1.592-3.696 2.48-5.922 2.458-4.713 0-8.533-3.82-8.533-8.533v-25.6h17.067zm51.2-68.267c0 14.138-11.462 25.6-25.6 25.6h-324.267c-14.138 0-25.6-11.462-25.6-25.6v-324.267c0-14.138 11.462-25.6 25.6-25.6h324.267c14.138 0 25.6 11.462 25.6 25.6zm42.667-42.667c4.713 0 8.533 3.821 8.533 8.533.007 2.299-.938 4.499-2.611 6.076-1.556 1.592-3.696 2.48-5.922 2.458h-25.6v-17.067zm0-85.333c4.713 0 8.533 3.82 8.533 8.533.007 2.299-.938 4.499-2.611 6.076-1.556 1.592-3.696 2.48-5.922 2.458h-25.6v-17.067zm0-85.333c4.713 0 8.533 3.82 8.533 8.533.007 2.299-.938 4.499-2.611 6.076-1.556 1.592-3.696 2.48-5.922 2.458h-25.6v-17.067z"
                />
              </g>
            </g>
          </g>
        </svg>
      </n-icon>
      <span style="font-size: 22px; padding-left: 10px">
        {{ t('home.lable.cpuUtilization') }}
      </span>
    </n-collapse-transition>
    <div style="padding-top: 15px">
      <n-collapse-transition
        :show="hardwareStore.cpu.utilizationUser != 0"
        style="display: flex; justify-content: center"
      >
        <div style="display: flex; font-size: 20px">
          <div :style="locale === 'zh_CN' ? 'min-width: 80px' : 'min-width: 85px'">
            {{ t('home.lable.utilizationUser') }}
          </div>
          <div style="padding-left: 10px; min-width: 50px">
            {{ hardwareStore.cpu.utilizationUser }}%
          </div>
        </div>
      </n-collapse-transition>
      <n-collapse-transition
        :show="hardwareStore.cpu.utilizationSystem != 0"
        style="display: flex; justify-content: center"
      >
        <div style="display: flex; font-size: 20px">
          <div :style="locale === 'zh_CN' ? 'min-width: 80px' : 'min-width: 85px'">
            {{ t('home.lable.utilizationSystem') }}
          </div>
          <div style="padding-left: 10px; min-width: 50px;">
            {{ hardwareStore.cpu.utilizationSystem }}%
          </div>
        </div>
      </n-collapse-transition>
      <n-collapse-transition
        :show="hardwareStore.cpu.utilizationIdle != 0"
        style="display: flex; justify-content: center"
      >
        <div style="display: flex; font-size: 20px">
          <div :style="locale === 'zh_CN' ? 'min-width: 80px' : 'min-width: 85px'">
            {{ t('home.lable.utilizationIdle') }}
          </div>
          <div style="padding-left: 10px; min-width: 50px">
            {{ hardwareStore.cpu.utilizationIdle }}%
          </div>
        </div>
      </n-collapse-transition>
    </div>
  </div>
</template>

<style scoped>
.cpu-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
}
</style>
